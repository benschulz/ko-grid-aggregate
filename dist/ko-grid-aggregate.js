/*
 Copyright (c) 2015, Ben Schulz
 License: BSD 3-clause (http://opensource.org/licenses/BSD-3-Clause)
*/
function m(l,p,c){return function(e){return e}(function(e,h){h.h("ko-grid-aggregate",{k:function(a){a.m("tfoot").l("aggregates",'<tr class="ko-grid-tr" data-bind="indexedRepeat: {  forEach: extensions.aggregate.__aggregateRows,  indexedBy: \'id\',  as: \'aggregateRow\'}">  <td class="ko-grid-tf ko-grid-aggregate"    data-bind="indexedRepeat: {      forEach: columns.displayed,      indexedBy: \'id\',      as: \'column\'    }"    data-repeat-bind="      __gridAggregate: aggregateRow()[column().id],      _gridWidth: column().width()"></td></tr>')},
e:function(a,h,d){var n=e.observable([]);this.__aggregateRows=n;if(Array.isArray(a)){var k=[];a.forEach(function(a){Object.keys(a).forEach(function(a){a=d.c.f(a).d;0>k.indexOf(a)&&k.push(a)})});var l=0,c=e.computed(function(){var e={},c=d.data.rows.all(),h=c.length;k.forEach(function(a){e[a]={minimum:Number.POSITIVE_INFINITY,maximum:Number.NEGATIVE_INFINITY,sum:0}});c.forEach(function(a){k.forEach(function(g){var b=e[g];g=d.data.n(a[g]);b.minimum=Math.min(b.minimum,g);b.maximum=Math.max(b.maximum,
g);b.sum+=g})});n(a.map(function(a){var g={id:""+ ++l};d.c.i().forEach(function(b){var d=b.id,f=b.d,c=a[d];if(c){if(h)if(f="average"===c?e[f].sum/h:e[f][c],1<=Math.abs(f))f=f.toLocaleString();else var k=-Math.floor(Math.log(f)/Math.log(10)),f=f.toLocaleString(void 0,{maximumFractionDigits:k+1});else f="N/A";b={b:b,a:c,value:f}}else b={b:b};g[d]=b});return g}))});this.dispose=function(){c.dispose()}}}});e.bindingHandlers.__gridAggregate={init:function(a){for(;a.firstChild;)e.removeNode(a.firstChild);
a.appendChild(window.document.createTextNode(""));return{controlsDescendantBindings:!0}},update:function(a,c){var d=c();a.className=["ko-grid-tf ko-grid-aggregate"+(d.a?" "+d.a:"")].concat(d.b.j()).join(" ");a.firstChild.nodeValue=d.a?d.value:""}};return h.g("aggregate","ko-grid-aggregate")}(c,l))}"function"===typeof define&&define.amd?define(["ko-grid","ko-indexed-repeat","knockout"],m):window["ko-grid-aggregate"]=m(window.ko.bindingHandlers.grid);
